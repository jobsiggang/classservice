# ğŸ›ï¸ ì•„í‚¤í…ì²˜ ìƒì„¸ ë¬¸ì„œ

## ğŸ“ ì‹œìŠ¤í…œ êµ¬ì¡°

### ì „ì²´ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Frontend Layer                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Student UI  â”‚  â”‚  Teacher UI  â”‚  â”‚   Admin UI   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–²â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ HTTPS / WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API Gateway (ì„ íƒ)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Auth Service  â”‚  â”‚User Service â”‚  â”‚Assignment Serviceâ”‚
â”‚   Port: 3001   â”‚  â”‚ Port: 3002  â”‚  â”‚   Port: 3003     â”‚
â”‚                â”‚  â”‚             â”‚  â”‚                  â”‚
â”‚ - ë¡œê·¸ì¸/ê°€ì…   â”‚  â”‚ - í•™êµ ê´€ë¦¬  â”‚  â”‚ - ê³¼ì œ CRUD      â”‚
â”‚ - JWT ë°œê¸‰     â”‚  â”‚ - í•™ê¸‰ ê´€ë¦¬  â”‚  â”‚ - ì œì¶œë¬¼ ê´€ë¦¬     â”‚
â”‚ - ê¶Œí•œ í™•ì¸    â”‚  â”‚ - í•™ìƒ ê´€ë¦¬  â”‚  â”‚ - í”¼ë“œë°±/ì ìˆ˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚                   â”‚
        â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
        â”‚     â”‚             â”‚                â”‚  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MongoDB (Multi-tenant Database)             â”‚
â”‚                                                          â”‚
â”‚  Collections:                                            â”‚
â”‚  â”œâ”€ users        (ëª¨ë“  ì‚¬ìš©ì, schoolIdë¡œ ë¶„ë¦¬)          â”‚
â”‚  â”œâ”€ schools      (í•™êµ ì •ë³´)                             â”‚
â”‚  â”œâ”€ classes      (í•™ê¸‰ ì •ë³´)                             â”‚
â”‚  â”œâ”€ assignments  (ê³¼ì œ)                                  â”‚
â”‚  â”œâ”€ submissions  (ì œì¶œë¬¼)                                â”‚
â”‚  â””â”€ files        (íŒŒì¼ ë©”íƒ€ë°ì´í„°)                       â”‚
â”‚                                                          â”‚
â”‚  Index: schoolId (ëª¨ë“  ì»¬ë ‰ì…˜)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚ Change Stream
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  Real-time Service â”‚
                  â”‚    Port: 3005      â”‚
                  â”‚                    â”‚
                  â”‚  - WebSocket       â”‚
                  â”‚  - Change Stream   â”‚
                  â”‚  - Push Notify     â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    File Service                           â”‚
â”‚                     Port: 3004                            â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   Multer   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   AWS S3       â”‚              â”‚
â”‚  â”‚  (Upload)  â”‚         â”‚  (Storage)     â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                           â”‚
â”‚  íŒŒì¼ ID ë°˜í™˜ â†’ Assignment/Submissionì—ì„œ ì°¸ì¡°           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ ë°ì´í„° íë¦„ ì˜ˆì‹œ

### 1ï¸âƒ£ í•™êµ ìƒì„± í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”    POST /schools     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚ User Service â”‚
â””â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚                 â”‚
              1. Create School   2. Create Admin
                    â”‚                 â”‚
                    â–¼                 â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚        MongoDB              â”‚
            â”‚  schools + users collection â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2ï¸âƒ£ ê³¼ì œ ìƒì„± â†’ ì‹¤ì‹œê°„ ì•Œë¦¼ í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  POST /assignments  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Teacher â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚Assignment Serviceâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                              1. Create Assignment
                                          â”‚
                                          â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚    MongoDB     â”‚
                                 â”‚  assignments   â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                              2. Change Stream Detected
                                          â”‚
                                          â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚  Real-time Sv. â”‚
                                 â”‚  (WebSocket)   â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                         3. Broadcast to School/Students
                                          â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                     â–¼              â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚Student 1 â”‚          â”‚Student 2 â”‚  â”‚Student 3 â”‚
              â”‚  (ì•Œë¦¼)   â”‚          â”‚  (ì•Œë¦¼)   â”‚  â”‚  (ì•Œë¦¼)   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3ï¸âƒ£ ê³¼ì œ ì œì¶œ í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Student â”‚                  â”‚ File Service â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                              â”‚
     â”‚ 1. Upload File              â”‚
     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
     â”‚                              â”‚
     â”‚                     2. Save to S3
     â”‚                              â”‚
     â”‚      3. Return fileId        â”‚
     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚                              
     â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚        â”‚Assignment Serviceâ”‚
     â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                 â”‚
     â”‚ 4. Submit with fileId
     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚
     â”‚                 â”‚
     â”‚        5. Create Submission
     â”‚                 â”‚
     â”‚                 â–¼
     â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚        â”‚  MongoDB   â”‚â”€â”€â”€â”€â”€â–¶â”‚ Real-time Sv.â”‚
     â”‚        â”‚submissions â”‚      â”‚  (Teacherì•Œë¦¼)â”‚
     â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” ì¸ì¦ ë° ê¶Œí•œ êµ¬ì¡°

### JWT í† í° êµ¬ì¡°

```javascript
{
  // Access Token Payload
  "userId": "65f...",
  "role": "teacher",
  "schoolId": "school_abc123",
  "iat": 1234567890,
  "exp": 1234654290  // 1ì¼ í›„
}

{
  // Refresh Token Payload
  "userId": "65f...",
  "iat": 1234567890,
  "exp": 1235172690  // 7ì¼ í›„
}
```

### ê¶Œí•œ ë§¤íŠ¸ë¦­ìŠ¤

| API Endpoint | Admin | Teacher | Student |
|-------------|-------|---------|---------|
| POST /schools | âœ… | âŒ | âŒ |
| POST /schools/:id/invite-teacher | âœ… | âŒ | âŒ |
| POST /classes | âœ… | âœ… | âŒ |
| POST /students | âœ… | âœ… | âŒ |
| POST /assignments | âœ… | âœ… | âŒ |
| GET /assignments | âœ… | âœ… | âœ… (ë³¸ì¸ ë°˜ë§Œ) |
| POST /submissions | âŒ | âŒ | âœ… |
| PATCH /submissions/:id/feedback | âœ… | âœ… | âŒ |
| POST /upload | âœ… | âœ… | âœ… |
| DELETE /files/:id | âœ… | âœ… (ë³¸ì¸) | âœ… (ë³¸ì¸) |

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### users Collection

```javascript
{
  _id: ObjectId("65f..."),
  name: "í™ê¸¸ë™",
  email: "student@school.com",
  password: "$2a$10$...",  // bcrypt hash
  role: "student",  // admin | teacher | student
  schoolId: "school_abc123",
  classId: "65f...",  // Optional, for students
  createdAt: ISODate("2025-01-01T00:00:00Z"),
  updatedAt: ISODate("2025-01-01T00:00:00Z"),
  lastLogin: ISODate("2025-11-15T10:00:00Z")
}
```

**Indexes:**
- `{ email: 1 }` - Unique
- `{ schoolId: 1, role: 1 }`
- `{ classId: 1 }`

### schools Collection

```javascript
{
  _id: "school_abc123def456",  // Custom ID
  name: "ì„œìš¸ê³ ë“±í•™êµ",
  createdAt: ISODate("2025-01-01T00:00:00Z"),
  updatedAt: ISODate("2025-01-01T00:00:00Z"),
  settings: {
    allowStudentSubmit: true,
    requireApproval: false
  }
}
```

### classes Collection

```javascript
{
  _id: ObjectId("65f..."),
  name: "3í•™ë…„ 1ë°˜",
  grade: "3",
  schoolId: "school_abc123",
  teacherIds: ["65f...", "65f..."],
  studentIds: ["65f...", "65f...", "65f..."],
  createdAt: ISODate("2025-01-01T00:00:00Z"),
  updatedAt: ISODate("2025-01-01T00:00:00Z")
}
```

**Indexes:**
- `{ schoolId: 1 }`
- `{ teacherIds: 1 }`

### assignments Collection

```javascript
{
  _id: ObjectId("65f..."),
  title: "ìˆ˜í•™ ê³¼ì œ 1",
  description: "1-10ë²ˆ ë¬¸ì œ í’€ì´",
  classId: "65f...",
  teacherId: "65f...",
  schoolId: "school_abc123",
  dueDate: ISODate("2025-12-31T23:59:59Z"),
  fileIds: ["file_abc123", "file_def456"],
  status: "active",  // active | archived
  createdAt: ISODate("2025-11-01T00:00:00Z"),
  updatedAt: ISODate("2025-11-01T00:00:00Z")
}
```

**Indexes:**
- `{ schoolId: 1, classId: 1 }`
- `{ teacherId: 1 }`
- `{ dueDate: 1 }`

### submissions Collection

```javascript
{
  _id: ObjectId("65f..."),
  assignmentId: "65f...",
  studentId: "65f...",
  schoolId: "school_abc123",
  content: "ê³¼ì œ ë‚´ìš©...",
  fileIds: ["file_xyz789"],
  submittedAt: ISODate("2025-11-15T10:00:00Z"),
  status: "submitted",  // submitted | graded
  grade: 95,
  feedback: "ì˜í–ˆìŠµë‹ˆë‹¤!",
  gradedAt: ISODate("2025-11-16T14:00:00Z"),
  gradedBy: "65f...",  // teacherId
  comments: [
    {
      id: "comment_abc123",
      userId: "65f...",
      content: "ì§ˆë¬¸ì´ ìˆìŠµë‹ˆë‹¤",
      createdAt: ISODate("2025-11-15T12:00:00Z")
    }
  ]
}
```

**Indexes:**
- `{ assignmentId: 1, studentId: 1 }` - Unique
- `{ schoolId: 1 }`
- `{ studentId: 1 }`

### files Collection

```javascript
{
  _id: "file_abc123def456",  // nanoid
  originalName: "report.pdf",
  fileName: "file_abc123def456_report.pdf",
  url: "https://bucket.s3.region.amazonaws.com/uploads/school_abc123/...",
  mimeType: "application/pdf",
  size: 102400,  // bytes
  uploaderId: "65f...",
  schoolId: "school_abc123",
  createdAt: ISODate("2025-11-15T09:00:00Z")
}
```

**Indexes:**
- `{ schoolId: 1 }`
- `{ uploaderId: 1 }`

---

## ğŸš€ í™•ì¥ì„± ê³ ë ¤ì‚¬í•­

### ìˆ˜í‰ í™•ì¥ (Horizontal Scaling)

ê° ì„œë¹„ìŠ¤ëŠ” ë…ë¦½ì ìœ¼ë¡œ í™•ì¥ ê°€ëŠ¥:

```
Auth Service:    [Instance 1] [Instance 2] [Instance 3]
User Service:    [Instance 1] [Instance 2]
Assignment Sv:   [Instance 1] [Instance 2] [Instance 3] [Instance 4]
File Service:    [Instance 1] [Instance 2]
Real-time Sv:    [Instance 1] [Instance 2]  + Redis Pub/Sub
```

### ë¡œë“œ ë°¸ëŸ°ì‹±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NGINX/   â”‚
â”‚ ALB      â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â–¶ Auth Service (Instance 1)
     â”œâ”€â–¶ Auth Service (Instance 2)
     â”œâ”€â–¶ Auth Service (Instance 3)
     â””â”€â–¶ ...
```

### ìºì‹± ì „ëµ

```javascript
// Redisë¥¼ ì‚¬ìš©í•œ ìºì‹±
// ìì£¼ ì¡°íšŒë˜ëŠ” ë°ì´í„°

// 1. í•™êµ ì •ë³´ (24ì‹œê°„)
redis.set(`school:${schoolId}`, JSON.stringify(schoolData), 'EX', 86400);

// 2. ì‚¬ìš©ì ì •ë³´ (1ì‹œê°„)
redis.set(`user:${userId}`, JSON.stringify(userData), 'EX', 3600);

// 3. ê³¼ì œ ëª©ë¡ (10ë¶„)
redis.set(`assignments:${classId}`, JSON.stringify(assignments), 'EX', 600);
```

---

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

### í—¬ìŠ¤ì²´í¬ ì—”ë“œí¬ì¸íŠ¸

ëª¨ë“  ì„œë¹„ìŠ¤ì— `/health` ì—”ë“œí¬ì¸íŠ¸:

```javascript
// GET /health
{
  "status": "OK",
  "service": "Auth Service",
  "uptime": 12345,
  "timestamp": "2025-11-15T10:00:00Z"
}
```

### ë¡œê¹… êµ¬ì¡°

```javascript
{
  "timestamp": "2025-11-15T10:00:00Z",
  "level": "info",
  "service": "assignment-service",
  "message": "Assignment created",
  "userId": "65f...",
  "schoolId": "school_abc123",
  "assignmentId": "65f...",
  "duration": 120  // ms
}
```

---

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### 1. ë°ì´í„° ê²©ë¦¬
- ëª¨ë“  ì¿¼ë¦¬ì— `schoolId` í•„í„° ì ìš©
- MongoDB Row-Level Security

### 2. Rate Limiting
```javascript
// express-rate-limit ì„¤ì •
const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15ë¶„
  max: 100 // ìµœëŒ€ 100 ìš”ì²­
});

app.use('/api/', limiter);
```

### 3. Input Validation
- ëª¨ë“  ì…ë ¥ sanitize
- XSS ë°©ì§€
- SQL/NoSQL Injection ë°©ì§€

### 4. HTTPS/WSS
í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ í•„ìˆ˜:
```
http://  â†’ https://
ws://    â†’ wss://
```

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

1. **API Gateway ì¶”ê°€**
   - Kong, AWS API Gateway
   - ë‹¨ì¼ ì§„ì…ì 
   - Rate limiting, Authentication

2. **Message Queue**
   - RabbitMQ / Kafka
   - ë¹„ë™ê¸° ì²˜ë¦¬ (ì´ë©”ì¼ ë°œì†¡ ë“±)

3. **ì„œë¹„ìŠ¤ ë©”ì‹œ**
   - Istio / Linkerd
   - ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê°„ í†µì‹  ê´€ë¦¬

4. **CI/CD Pipeline**
   - GitHub Actions
   - Docker + Kubernetes ë°°í¬

5. **ê´€ì¸¡ì„± (Observability)**
   - Prometheus + Grafana (ë©”íŠ¸ë¦­)
   - ELK Stack (ë¡œê·¸)
   - Jaeger (ë¶„ì‚° ì¶”ì )
